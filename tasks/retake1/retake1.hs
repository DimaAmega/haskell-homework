{-# LANGUAGE FlexibleContexts #-}

import Data.Semigroup
import Data.Monoid
import Control.Monad.Writer

-- 1. Prelude –≥–æ–≤–æ—Ä–∏—Ç, —Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è div x y –¥–ª—è —Ü–µ–ª—ã—Ö x –∏ y
-- —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç–Ω–æ–µ x –∏ y, –æ–∫—Ä—É–≥–ª–µ–Ω–Ω–æ–µ –≤–Ω–∏–∑ (—Ç–æ –µ—Å—Ç—å –∫ –º–∏–Ω—É—Å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏).
-- –û–¥–Ω–∞–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ

-- -7 `div` 3

-- –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç -2, –∞ –Ω–µ -3, –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã–ª–æ –æ–∂–∏–¥–∞—Ç—å. –û–±—ä—è—Å–Ω–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ,
-- –ø–æ—á–µ–º—É —Ç–∞–∫ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏ –∫–∞–∫ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
-- —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ –¥–µ–ª–µ–Ω–∏—è -7 –Ω–∞ 3.

-- –£–∫–∞–∑–∞–Ω–∏–µ. –ú–æ–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–æ–º–∞–Ω–¥–æ–π :i –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ GHCi,
-- –ø–µ—á–∞—Ç–∞—é—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω–∞—Ö. –ü–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ç–∞–∫–∂–µ
-- —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ Prelude –∏ —Ä–∞–∑–¥–µ–ª–∞—Ö 3.4 –∏ 4.4.2 Haskell 2010 Language
-- Report.

------------------------------- –û–¢–í–ï–¢ ---------------------------------------
-- –í –æ—Å–Ω–æ–≤–µ —è–∑—ã–∫–∞ haskell –ª–µ–∂–∏—Ç –ª–∞–º–±–¥–∞ –∏—Å—á–∏—Å–ª–µ–Ω–∏–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
-- 2 –æ–ø–µ—Ä–∞—Ü–∏–∏: –∞–ø–ø–ª–∏–∫–∞—Ü–∏—è –∏ Œª-–∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è. 
-- 
-- fun fact: –∫–æ—Å–∞—è —á–µ—Ä—Ç–∞ –≤ Haskell –∫–∞–∫ —Ä–∞–∑ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç Œª
-- 
-- –í haskell Œª-–∞–±—Å—Ç—Ä–∞–∫—Ü–∏—é –Ω–∞–∑—ã–≤–∞—é—Ç –ø—Ä–æ—Å—Ç–æ —Ñ—É–Ω–∫—Ü–∏–µ–π, –∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã - —ç—Ç–æ –Ω–∞ —Å–∞–º–æ–º 
-- –¥–µ–ª–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π —Å–∞—Ö–∞—Ä –¥–ª—è –∞–ø–ø–ª–∏–∫–∞—Ü–∏–∏ –¥–≤—É—Ö (–∏–ª–∏ –æ–¥–Ω–æ–≥–æ) —Ç–µ—Ä–º–∞ –∫ 
-- Œª-–∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è–º. –ù–∞–ø—Ä–∏–º–µ—Ä 2 + 3, –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ—Ç—Å—è –≤ core haskell
-- –≤ –≤–∏–¥ (+) 2 3
-- –¢–µ–ø–µ—Ä—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ:
-- –í Haskell —Ñ—É–Ω–∫—Ü–∏–∏, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –¥–ª—è –∏–Ω—Ñ–∏–∫—Å–Ω–æ–π —Ñ–æ—Ä–º—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è, –Ω–∞–∑—ã–≤–∞—é—Ç 
-- –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏, –∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –∑–∞–∫–ª—é—á–µ–Ω–æ –≤ —Å–∫–æ–±–∫–∏.
-- –ï—Å–ª–∏ –≤ ghci  –ø—Ä–æ–ø–∏—Å–∞—Ç—å ":i div" –∏  ":i -", —Ç–æ —É–≤–∏–¥–∏–º —Å–ª–µ–¥—É—â–µ–µ:
--              Prelude> :i div
--              type Integral :: * -> Constraint
--              class (Real a, Enum a) => Integral a where
--                ...
--                div :: a -> a -> a
--                ...
--                      -- Defined in ‚ÄòGHC.Real‚Äô
--              infixl 7 `div`
--              Prelude> :i -
--              type Num :: * -> Constraint
--              class Num a where
--                ...
-- IMPORTANT -->  (-) :: a -> a -> a
--                ...
--                      -- Defined in ‚ÄòGHC.Num‚Äô
--              infixl 6 -
-- 
-- –í–∏–¥–∏–º, —á—Ç–æ –º–∏–Ω—É—Å –∑–∞–∫–ª—é—á–µ–Ω –≤ —Å–∫–æ–±–∫–∏, –∑–Ω–∞—á–∏—Ç —Å–µ–º–∞–Ω–∏—á–µ—Å–∫–∏ —è–≤–ª—è–µ—Ç—Å—è 
-- –±–∏–Ω–∞—Ä–Ω—ã–º, –ª–µ–≤–æ–∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º 6
--
-- div –∂–µ –ø—Ä–æ—Å—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É—è –µ–µ –≤ –∏–Ω—Ñ–∏–∫—Å–Ω–æ–π 
-- —Ñ–æ—Ä–º–µ –∑–∞–ø–∏—Å–∏ (–∏—Å–ø–æ–ª—å–∑—É—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–≤–æ—Ç—ã ``) –æ–Ω–∞ —è–≤–ª—è–µ—Ç—Å—è 
-- –±–∏–Ω–∞—Ä–Ω—ã–º, –ª–µ–≤–æ–∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º 7
--
-- –ù–æ –≤ –∑–∞–ø–∏—Å–∏ "-7 `div` 3"
-- –º–∏–Ω—É—Å —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —É–Ω–∞—Ä–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä 
-- –≤ Haskell) –∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø—Ä–µ—Ñ–∏–∫—Å –æ—Ç—Ä–∏—Ü–∞–Ω–∏—è. –í –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Haskell —Å–∫–∞–∑–∞–Ω–æ,
-- —á—Ç–æ –ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–π –º–∏–Ω—É—Å –æ–±–ª–∞–¥–∞–µ—Ç —Ç–∞–∫–∏–º –∂–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –∫–∞–∫ –∏ –±–∏–Ω–∞—Ä–Ω—ã–π –º–∏–Ω—É—Å,
-- —Ç–æ –µ—Å—Ç—å (–∫–∞–∫ –º–æ–∂–Ω–æ —â–∞–º–µ—Ç–∏—Ç—å –≤—ã—à–µ) –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ä–∞–≤–Ω—è–µ—Ç—Å—è 6.
-- –¢–∞–∫–∂–µ –≤ Haskell –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è negate, –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ–∏–Ω—Å–ø–µ–∫—Ç–∏—Ä—É–µ–º –µ–µ –≤ 
-- GHCI
--              Prelude> :i negate
--              type Num :: * -> Constraint
--              class Num a where
--                ...
--                negate :: a -> a
--                ...
--                      -- Defined in ‚ÄòGHC.Num‚Äô
--
-- –í core Haskell –∑–∞–ø–∏—Å—å –≤–∏–¥–∞ "-a" –∫–∞–∫ —Ä–∞–∑ —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ—Ç—Å—è –≤ "negate a"
-- –∏ —Ç—É—Ç –∫–∞–∫ –≤—Å–µ–≥–¥–∞ –Ω–µ—Ç –Ω–∏–∫–∞–∫–æ–π –º–∞–≥–∏–∏, –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏.
--
-- –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —É –ø—Ä–µ–¥–∏–∫–∞—Ç–∞ –æ—Ç—Ä–∏—Ü–∞–Ω–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∏–∂–µ —á–µ–º —É 
-- –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ `div` –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á—Ç–æ —Å–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è 7 `div` 3
-- –∞ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º negate –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, negate 2, –ø–æ–ª—É—á–∞—è -2
--
-- –ò–∑–±–µ–∂–∞—Ç—å –¥–∞–Ω–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ, –≤–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤:
-- negate 7 `div` 3     (—É –∞–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞–∏–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
-- (-7) `div` 3         (—Ä–∞—Å—Å—Ç–∞–≤–ª—è–µ–º —Å–∫–æ–±–∫–∏)
-- div (-7) 3           (—Ä–∞—Å—Å—Ç–∞–≤–ª—è–µ–º —Å–∫–æ–±–∫–∏)
-- div (negate 7) 3     (—Ä–∞—Å—Å—Ç–∞–≤–ª—è–µ–º —Å–∫–æ–±–∫–∏)
------------------------------------------------------------------------------

-- 2. –°–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞ –±—ã–ª–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∞ –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ
-- –≤–µ—Å–µ–Ω–Ω–µ–≥–æ —Å–µ–º–µ—Å—Ç—Ä–∞, –æ–¥–Ω–∞–∫–æ –≤—Å–µ —Ä–µ—à–µ–Ω–∏—è –±—ã–ª–∏ –∏–∑–ª–∏—à–Ω–µ —Å–ª–æ–∂–Ω—ã–º–∏.

-- –ë–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ–∫—É—Ä—Å–∏–∏ –Ω–∞–ø–∏—à–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é abbrev :: [String] -> String,
-- –∫–æ—Ç–æ—Ä–∞—è –≤ –∑–∞–¥–∞–Ω–Ω–æ–º —Å–ø–∏—Å–∫–µ –∏–º–µ–Ω –ª—é–¥–µ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Å–µ—Ö
-- –∏–º–µ–Ω, –∫—Ä–æ–º–µ —Ñ–∞–º–∏–ª–∏–∏, –¥–æ –∏–Ω–∏—Ü–∏–∞–ª–æ–≤. –§–∞–º–∏–ª–∏–µ–π —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–µ–µ
-- —Å–ª–æ–≤–æ. –ù–∞–ø—Ä–∏–º–µ—Ä:

-- > putStrLn $ abbrev ["–°–∏–Ω–∏—Ü–∏–Ω"]
-- "–°–∏–Ω–∏—Ü–∏–Ω"
-- > putStrLn $ abbrev ["–°–µ—Ä–≥–µ–π", "–ï—Å–µ–Ω–∏–Ω"]
-- "–°.–ï—Å–µ–Ω–∏–Ω"
-- putStrLn $ abbrev ["–ò–≥–æ—Ä—å", "–§–µ–¥–æ—Ä–æ–≤–∏—á", "–ü–æ–¥–¥—É–±–Ω—ã–π"]
-- "–ò.–§.–ü–æ–¥–¥—É–±–Ω—ã–π"
-- putStrLn $ abbrev ["–ò–æ–≥–∞–Ω–Ω", "–•—Ä–∏–∑–æ—Å—Ç–æ–º", "–í–æ–ª—å—Ñ–≥–∞–Ω–≥", "–ê–º–∞–¥–µ–π", "–ú–æ—Ü–∞—Ä—Ç"]
-- "–ò.–•.–í.–ê.–ú–æ—Ü–∞—Ä—Ç"

-- –†–µ—à–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–º —É—Å–ª–æ–≤–∏—è–º.

-- (–∞) –û–Ω–æ –¥–æ–ª–∂–Ω–æ —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ—á–∫–∏, –Ω–µ —Å—á–∏—Ç–∞—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Ç–∏–ø–∞.
-- (–±) –°–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤—É—é —Å–≤–µ—Ä—Ç–∫—É –¥–ª—è –Ω–µ–ø—É—Å—Ç—ã—Ö —Å–ø–∏—Å–∫–æ–≤.
-- (–≤) –§—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å O(n), –≥–¥–µ n ‚Äî –¥–ª–∏–Ω–∞
-- —Å–ø–∏—Å–∫–∞, –Ω–æ –Ω–µ –æ–±—â–∞—è –¥–ª–∏–Ω–∞ —Å–ª–æ–≤ –≤ —Å–ø–∏—Å–∫–µ.
-- (–≥) –ù–µ —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é (++) —Ç–∞–º, –≥–¥–µ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å
-- –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏.

abbrev :: [String] -> String
abbrev = foldr1 (\w acc -> head w : '.' : acc)

-- 3. –ù–∞–ø–∏—à–∏—Ç–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é

foldMapList :: Monoid m => (a -> m) -> [a] -> m
foldMapList f [] = mempty
foldMapList f (x:xs) = f x <> foldMapList f xs


-- –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è —á–ª–µ–Ω—Å—Ç–≤–∞ —Ç–∏–ø–∞ —Å–ø–∏—Å–∫–æ–≤
-- –≤ –∫–ª–∞—Å—Å–µ Foldable.

-- 4. –í Prelude —Ñ—É–Ω–∫—Ü–∏–∏ foldr –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ foldMap —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º.

-- foldr f z t = appEndo (foldMap (Endo . f) t) z

-- –° —É—á–µ—Ç–æ–º –≤–∞—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –≤–æ–ø—Ä–æ—Å –æ–±—ä—è—Å–Ω–∏—Ç–µ, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
-- —ç—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ t ‚Äî —Å–ø–∏—Å–æ–∫, –∏ –ø–æ—á–µ–º—É –æ–Ω–æ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ
-- –æ–±—ã—á–Ω–æ–º—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é –∏–∑ –ª–µ–∫—Ü–∏–∏ 5.

-- –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤ –Ω–∞—á–∞–ª–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ "foldMap (Endo . f) t"
-- –≤—Å–ø–æ–º–Ω–∏–º —Å–∏–≥–Ω–∞—Ç—É—Ä—É f: 
-- f :: a -> b -> b
-- –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ a - —ç–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–∞, —Ç–æ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è, —á—Ç–æ
-- –ø—Ä–∏–º–µ–Ω—è—è (Endo . f) –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º —Å–ø–∏—Å–∫–∞, –º—ã –ø–æ–ª—É—á–∞–µ–º –º–æ–Ω–æ–∏–¥ 
-- —ç–Ω–¥–æ–º–æ—Ä—Ñ–∏–∑–º–æ–≤ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π —Å–∏–≥–Ω–∞—Ç—É—Ä—ã b -> b –≤–Ω—É—Ç—Ä–∏. 
-- –ü—Ä–∏—á–µ–º —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ö—Ä–∞–Ω–∏—Ç –≤ —Å–≤–æ–µ–º –∑–∞–º—ã–∫–∞–Ω–∏–∏ —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞.
-- –≠—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç!
-- 
-- –ø—É—Å—Ç—å –µ—Å—Ç—å —Å–ø–∏—Å–∫–æ–∫ [a1, a2, ... an]
-- foldMap (Endo . f) [a1, a2, ... an]
-- —Ä–µ–¥—É—Ü–∏—Ä—É–µ—Ç—Å—è –¥–æ
-- A = (Endo . f) a1 <> ((Endo . f) a2 <> ((Endo . f) a3 <> ... <> (Endo . f) an))
-- –û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ A —Ç–∞–∫–∂–µ —è–≤–ª—è–µ—Ç—Å—è –º–æ–Ω–æ–∏–¥–æ–º —ç–Ω–¥–æ–º–æ—Ä—Ñ–∏–∑–º–æ–≤
-- –û—Ç–º–µ—Ç–∏–º, —á—Ç–æ –≤ —Å–ª—É—á–∞–µ –º–æ–Ω–æ–∏–¥–∞ —ç–Ω–¥–æ–º–æ—Ä—Ñ–∏–∑–º–æ–≤ –æ–ø–µ—Ä–∞—Ç–æ—Ä <>
-- —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –∫–∞–∫:
-- (Endo f) <> (Endo g) = Endo (f . g)
-- –î–∞–ª–µ–µ –º—ã –ø—Ä–∏–º–µ–Ω—è–µ–º appEndo –∫ A —Å –Ω–∞—á–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º z, –∑–∞–ø—É—Å–∫–∞—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ
-- appEndo A z
-- –¢–µ–ø–µ—Ä—å —É–∂–µ –Ω–µ —Å–ª–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–µ–¥—É–∫—Ü–∏–∏ –ø–æ–ª—É—á–∏—Ç—Å—è:
-- f a1 ( ... (f an-2 (f an-1 (f an z))))
-- –≠—Ç–æ –∫–∞–∫ —Ä–∞–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é –ø—Ä–∞–≤–æ–π —Å–≤–µ—Ä—Ç–∫–∏ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ 
-- f —Å –Ω–∞—á –∑–Ω–∞—á–µ–Ω–∏–µ–º z –Ω–∞–¥ —ç–ª–ª–µ–º–µ–Ω—Ç–∞–º–∏ [a1, a2, ..., an]
-- 5. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–ª–µ–¥—É—é—â–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

l :: [String]
l = ["ab", "cd", "ef"]

f1 :: [String] -> String -> String
f1 = mconcat . map showString

f2 :: [String] -> String -> String
f2 = appEndo . mconcat . map (Endo . showString)

-- –û–±—ä—è—Å–Ω–∏—Ç–µ, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç f1 –∏ f2, –≤ —á–µ–º –º–µ–∂–¥—É –Ω–∏–º–∏ —Ä–∞–∑–Ω–∏—Ü–∞ –∏ –∫–∞–∫–æ–≤–∞ –µ–µ –ø—Ä–∏—á–∏–Ω–∞.

-- –£–∫–∞–∑–∞–Ω–∏–µ. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–Ω–æ–∏–¥–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–∞—Ö, –≤ —Ç–æ–º
-- —á–∏—Å–ª–µ –Ω–∞ —Ç–∏–ø–µ —Ñ—É–Ω–∫—Ü–∏–π (a -> b) –∏ —Ç–∏–ø–µ —ç–Ω–¥–æ–º–æ—Ä—Ñ–∏–∑–º–æ–≤ (Endo a),
-- –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –º–æ–¥—É–ª–µ Data.Semigroup.

-- 6. –ù–∞–ø–∏—à–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é

minMax :: [Int] -> (Int, Int)
minMax = undefined

-- –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–∞—Ä—É, —Å–æ—Å—Ç–æ—è—â—É—é –∏–∑ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ
-- —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–µ–ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞. –û–Ω–∞ –¥–æ–ª–∂–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é
-- —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é —Ä–∞–±–æ—Ç—É.

minMaxLoop :: [Int] -> Writer (Min Int, Max Int) ()
minMaxLoop = undefined

-- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ Min a –∏ Max a, —è–≤–ª—è—é—â–∏—Ö—Å—è –º–æ–Ω–æ–∏–¥–∞–º–∏ —Å –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
-- min –∏ max, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –º–æ–¥—É–ª—è—Ö Data.Semigroup –∏
-- Data.Monoid. –û–Ω–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã –º–æ–Ω–æ–∏–¥–∞–º Sum a –∏ Product a,
-- —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–º –Ω–∞ –ª–µ–∫—Ü–∏—è—Ö.

-- –§—É–Ω–∫—Ü–∏—è minMaxLoop –Ω–µ –¥–æ–ª–∂–Ω–∞ —è–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ
-- —Ñ—É–Ω–∫—Ü–∏–∏ min, max, minimum –∏ maximum. –í –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ minMax –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
-- —Ñ—É–Ω–∫—Ü–∏—é execWriter, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –≤ Control.Monad.Writer.

-- 7. –ü–æ–¥—Å—Ç–∞–≤—å—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π flip –∏ (.) –∏–∑ Prelude –≤ —Ç–µ—Ä–º
-- flip (.) –∏, –≤—ã–ø–æ–ª–Ω—è—è –ø–æ –æ–¥–Ω–æ–π —Ä–µ–¥—É–∫—Ü–∏–∏ –∑–∞ —à–∞–≥, –Ω–∞–π–¥–∏—Ç–µ –Ω–æ—Ä–º–∞–ª—å–Ω—É—é
-- —Ñ–æ—Ä–º—É —ç—Ç–æ–≥–æ —Ç–µ—Ä–º–∞.
-- 
-- –ù–∞ —è–∑—ã–∫–µ –ª—è–º–±–¥–∞ –∏—Å—á–∏—Å–ª–µ–Ω–∏—è –º—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å flip –∫–∞–∫:
-- flip = \f -> \x -> \y -> f y x
-- –ù–∞—á–Ω–µ–º —Ä–µ–¥—É–∫—Ü–∏—é
-- flip (.) ==Œ≤ (\f -> \x -> \y -> f y x) (.)
-- (\f -> \x -> \y -> f y x) (.) ==Œ≤ \x -> \y -> (.) y x
-- \x -> \y -> (.) y x ==Œ≤ \x -> \y -> \z -> y (x z)
-- –ò—Ç–æ–≥–æ
-- \x -> \y -> \z -> y (x z)
-- 
-- –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Ä–µ–¥—É–∫—Ü–∏–∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Å–ª—É—á–∞–µ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –Ω–µ 
-- –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ (–∞ –∫–∞–∫ —Ä—É–∫–∞ –ø–æ–ª–æ–∂–∏—Ç üòÄ), –Ω–æ –∑–∞—Ç–æ –º—ã –ª–µ–≥–∫–æ 
-- –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç–≤–µ—Ç. –ù–∏–∂–µ –±—É–¥–µ–º –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ –æ–¥–Ω–æ–π —Ä–µ–¥—É–∫—Ü–∏–∏ 
-- –∑–∞ —à–∞–≥ –∫–∞–∫ –ø–æ–ª–æ–∂–µ–Ω–æ –∏ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ (—Å–ø–æ–π–ª–µ—Ä)
-- –æ—Ç–≤–µ—Ç—ã —Å–æ–≤–ø–∞–¥—É—Ç üòé
--
--  –ò–º–µ–µ–º
--  flip (.)
--  –ù–∞—á–Ω–µ–º —Å–æ–≤–µ—Ä—à–∞—Ç—å Œ≤ —Ä–µ–¥—É–∫—Ü–∏–∏
-- (\f -> \x -> \y -> f y x) (\b -> \k -> \z -> b (k z))
--  Œ≤ —Ä–µ–¥—É–∫—Ü–∏—è
-- \x -> \y -> (\b -> \k -> \z -> b (k z)) y x
--  Œ≤ —Ä–µ–¥—É–∫—Ü–∏—è
-- \x -> \y -> (\k -> \z -> y (k z)) x
--  Œ≤ —Ä–µ–¥—É–∫—Ü–∏—è
-- \x -> \y -> (\z -> y (x z))
--  —Ç–∞–∫ –∫–∞–∫ —Ç–µ–ª–æ –ª—è–º–±–¥–∞ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –ø—Ä–æ—Å—Ç–∏—Ä–∞–µ—Ç—Å—è –¥–æ –∫–æ–Ω—Ü–∞ –≤–ø—Ä–∞–≤–æ,
--  —Å–∫–æ–±–∫–∏ —Ç—É—Ç –Ω–µ –Ω—É–∂–Ω—ã
-- \x -> \y -> \z -> y (x z)
